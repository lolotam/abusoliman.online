<div class="section-header">
    <h2><i class="fas fa-shopping-cart"></i> المبيعات</h2>
    <div class="section-actions">
        <button class="btn primary" onclick="newSale()">
            <i class="fas fa-plus"></i>
            فاتورة جديدة
        </button>
        <button class="btn secondary" onclick="showSalesHistory()">
            <i class="fas fa-history"></i>
            سجل المبيعات
        </button>
    </div>
</div>

<!-- نظام نقاط البيع -->
<div class="pos-container">
    <div class="pos-grid">
        <!-- منطقة المنتجات -->
        <div class="products-area">
            <div class="products-header">
                <div class="search-container">
                    <input type="text" id="productSearch" class="form-input" placeholder="البحث عن منتج..." onkeyup="searchProducts(this.value)">
                    <i class="fas fa-search"></i>
                </div>
                <div class="category-filter">
                    <select id="categoryFilter" class="form-select" onchange="filterByCategory(this.value)">
                        <option value="">جميع الفئات</option>
                    </select>
                </div>
            </div>
            
            <div class="products-grid" id="productsGrid">
                <!-- المنتجات ستظهر هنا -->
            </div>
        </div>

        <!-- منطقة السلة -->
        <div class="cart-area">
            <div class="cart-header">
                <h3><i class="fas fa-shopping-cart"></i> السلة</h3>
                <button class="btn btn-sm secondary" onclick="clearCart()">
                    <i class="fas fa-trash"></i>
                    مسح الكل
                </button>
            </div>

            <div class="cart-items" id="cartItems">
                <!-- عناصر السلة ستظهر هنا -->
            </div>

            <div class="cart-summary">
                <div class="summary-row">
                    <span>المجموع الفرعي:</span>
                    <span id="subtotal">٠.٠٠٠ د.ك</span>
                </div>
                <div class="summary-row">
                    <span>الخصم:</span>
                    <div class="discount-input">
                        <input type="number" id="discountAmount" class="form-input" placeholder="0" min="0" step="0.001" onchange="updateTotals()">
                        <select id="discountType" class="form-select" onchange="updateTotals()">
                            <option value="amount">د.ك</option>
                            <option value="percentage">%</option>
                        </select>
                    </div>
                </div>
                <div class="summary-row">
                    <span>الضريبة:</span>
                    <div class="tax-input">
                        <input type="number" id="taxAmount" class="form-input" placeholder="0" min="0" step="0.001" onchange="updateTotals()">
                        <select id="taxType" class="form-select" onchange="updateTotals()">
                            <option value="amount">د.ك</option>
                            <option value="percentage">%</option>
                        </select>
                    </div>
                </div>
                <div class="summary-row total">
                    <span>الإجمالي:</span>
                    <span id="total">٠.٠٠٠ د.ك</span>
                </div>
            </div>

            <div class="customer-selection">
                <label class="form-label">العميل:</label>
                <div class="customer-input-group">
                    <select id="customerSelect" class="form-select">
                        <option value="">اختر العميل</option>
                    </select>
                    <button class="btn btn-sm info" onclick="addNewCustomer()">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>

            <div class="payment-section">
                <label class="form-label">طريقة الدفع:</label>
                <div class="payment-methods">
                    <label class="payment-method">
                        <input type="radio" name="paymentMethod" value="cash" checked>
                        <span><i class="fas fa-money-bill"></i> نقداً</span>
                    </label>
                    <label class="payment-method">
                        <input type="radio" name="paymentMethod" value="card">
                        <span><i class="fas fa-credit-card"></i> بطاقة</span>
                    </label>
                    <label class="payment-method">
                        <input type="radio" name="paymentMethod" value="credit">
                        <span><i class="fas fa-clock"></i> آجل</span>
                    </label>
                </div>
            </div>

            <div class="checkout-actions">
                <button class="btn primary btn-lg" onclick="completeSale()" id="checkoutBtn" disabled>
                    <i class="fas fa-check"></i>
                    إتمام البيع
                </button>
                <button class="btn secondary" onclick="saveDraft()">
                    <i class="fas fa-save"></i>
                    حفظ مسودة
                </button>
            </div>
        </div>
    </div>
</div>

<!-- نافذة تأكيد البيع -->
<div id="saleConfirmModal" class="modal-overlay hidden">
    <div class="modal medium">
        <div class="modal-header">
            <h3>تأكيد البيع</h3>
            <button class="modal-close" onclick="closeSaleConfirm()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="sale-summary">
                <h4>ملخص الفاتورة</h4>
                <div id="saleConfirmDetails"></div>
            </div>
            <div class="payment-details">
                <div class="form-group">
                    <label class="form-label">المبلغ المدفوع:</label>
                    <input type="number" id="paidAmount" class="form-input" step="0.001" onchange="calculateChange()">
                </div>
                <div class="form-group">
                    <label class="form-label">الباقي:</label>
                    <input type="text" id="changeAmount" class="form-input" readonly>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn primary" onclick="confirmSale()">
                    <i class="fas fa-check"></i>
                    تأكيد البيع
                </button>
                <button class="btn secondary" onclick="closeSaleConfirm()">
                    <i class="fas fa-times"></i>
                    إلغاء
                </button>
            </div>
        </div>
    </div>
</div>
